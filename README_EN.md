![img.png](logo.png)
# TABBY
![Java version](https://img.shields.io/badge/Java-17-blue.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)
![Blackhat](https://img.shields.io/badge/Blackhat-Arsenal%202024-red.svg)

TABBY is a static code analysis tool tailored for the Java language, designed to swiftly uncover a multitude of vulnerabilities specific to Java.

TABBY leverages the [Soot](https://github.com/soot-oss/soot) static analysis framework as its semantic extraction engine to convert JAR/WAR/CLASS files into Code Property Graphs (CPGs). It then employs the [Neo4j](https://neo4j.com/) graph database to store these generated CPGs.

Furthermore, by extending Neo4j's [path traversal logic](https://github.com/wh1t3p1g/tabby-path-finder), TABBY can perform complex taint analysis and output potential vulnerability call chains with straightforward Cypher queries.

## #1 Usage

To use Tabby, the following environment requirements must be met:

- JAVA Environment
- An available Neo4j graph database
- Neo4j Browser or another visualization tool for Neo4j, or the [Tabby IDEA Plugin](https://github.com/wh1t3p1g/tabby-intellij-plugin)

For detailed instructions on how to use Tabby, please refer to the [Tabby Quick Start Guide](https://www.yuque.com/wh1t3p1g/tp0c1t/lf12lg69ngh47akx).

## #2 Target Audience for Tabby

The development of Tabby was initiated with the aim of enhancing the efficiency of code audits and minimizing the workload associated with manual searches.

With the Code Property Graphs generated by Tabby , the following scenarios can be addressed:

- Identifying deserialization exploitation chains within target projects, supporting a wide range of serialization mechanisms, including Java's native serialization, Hessian, XStream, and others.
- Uncovering common web vulnerabilities within target projects, capable of analyzing WAR/JAR/FATJAR/JSP/CLASS files.
- Searching for functions or classes that meet specific criteria, such as static methods that invoke dangerous functions.

By leveraging the Code Property Graphs generated by Tabby, users can conduct dynamic, custom vulnerability mining and exploitation chain analysis within the Neo4j graph database.

## #3 Achievements

- [Existing Exploit Chain Coverage](https://github.com/wh1t3p1g/tabby/wiki/%E7%8E%B0%E6%9C%89%E5%88%A9%E7%94%A8%E9%93%BE%E8%A6%86%E7%9B%96)
- Papers && Slides
  - KCon 2022 [Tabby: Java Code Review Like A Pro](https://github.com/knownsec/KCon/blob/master/2022/tabby%20java%20code%20review%20like%20a%20pro%E3%80%90KCon2022%E3%80%91.pdf)
  - KCon Topic Supplement [Automated Vulnerability Mining Practice Based on Code Property Graphs](https://blog.0kami.cn/blog/2023/%E5%9F%BA%E4%BA%8E%E4%BB%A3%E7%A0%81%E5%B1%9E%E6%80%A7%E5%9B%BE%E7%9A%84%E8%87%AA%E5%8A%A8%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E5%AE%9E%E8%B7%B5/)
  - DSN 2023 [Tabby: Automated Gadget Chain Detection for Java Deserialization Vulnerabilities](https://ieeexplore.ieee.org/document/10202660)
  - BlackHat EU 2024 [Tabby: Simplifying the Art of Java Vulnerability Hunting](https://github.com/wh1t3p1g/tabby/blob/v2/papers/Tabby%20Simplifying%20the%20Art%20of%20Java%20Vulnerability%20Hunting.pdf)
  - ICASSP 2025 [VulKiller: Java Web Vulnerability Detection with Code Property Graph and Large Language Models]() 
- CVEs
  - CVE-2021-21346
  - CVE-2021-21351
  - CVE-2021-39147
  - CVE-2021-39148
  - CVE-2021-39152 m0d9
  - CVE-2021-43297
  - CVE-2022-39198 yemoli
  - CVE-2023-23638

## #4 Frequently Asked Questions

- [FAQ](https://www.yuque.com/wh1t3p1g/tp0c1t/ueduxuz6fmxhpoyb)

If you encounter any other issues while using Tabby, feel free to ask in the [discussions](https://github.com/wh1t3p1g/tabby/discussions)!

If you discover any bugs in the implementation of Tabby, please submit the relevant error details in the [issues](https://github.com/wh1t3p1g/tabby-path-finder/issues) section.

## #5 Motivation & Acknowledgments

Initially, during the process of exploit chain analysis, it became clear that this process could be automated (whether for Java or PHP). However, there was a noticeable lack of open-source tools in this area within China. Existing GI tools did not perform well in practical detection scenarios. Based on my understanding of program analysis, I developed the Tabby tool. My vision for Tabby extends beyond just exploit chain mining; I also hope that it can be utilized from a vulnerability analysis perspective, leveraging its Code Property Graphs for deeper insights. It is my wish that Tabby introduces a new working model for Java security researchers.

Of course, the current version of Tabby still has many areas for improvement, and I welcome developers with experience in program analysis to join in the development of Tabby. If you have any questions, feel free to contact me directly!

If Tabby has facilitated your work, please do not hesitate to give it a star ‚≠ê!

If you discover vulnerabilities using Tabby, we warmly welcome you to share related success stories.

If you are able to contribute to its development, let's engage in discussions, or submit Pull Requests or Issues directly.

- [soot](https://github.com/soot-oss/soot)
- [gadgetinspector](https://github.com/JackOfMostTrades/gadgetinspector)
- [ysoserial](https://github.com/frohoff/ysoserial) && [marshalsec](https://github.com/mbechler/marshalsec)
